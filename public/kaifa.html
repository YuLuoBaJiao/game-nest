<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>开发者创作中心</title>
    <link rel="stylesheet" href="style.css">
    <style>
        /* 开发者中心专属样式 */
        /* 天空主题配色 */
body {
    background: linear-gradient(150deg, #f0f9ff 0%, #9bcff7 80%);
    min-height: 100vh;
}

.dev-container {
    background: rgba(255, 255, 255, 0.95);
    border-radius: 20px;
    box-shadow: 0 12px 40px rgba(173, 216, 230, 0.2);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.3);
}

/* 云朵动态背景 */
.cloud-bg {
    position: fixed;
    width: 200%;
    height: 100%;
    z-index: 0;
    background: url('data:image/svg+xml,\<svg width="100" height="60" viewBox="0 0 100 60" xmlns="http://www.w3.org/2000/svg">\<path fill="%23ffffff" opacity="0.4" d="M23.8 22c-4.8 0-8.7-3.9-8.7-8.7 0-4.8 3.9-8.7 8.7-8.7 2.2 0 4.2.8 5.8 2.2-.3-1.2-.5-2.5-.5-3.8C29.1 3.1 33.2 0 38 0c3.5 0 6.6 1.9 8.3 4.7 1.5-1.4 3.4-2.2 5.5-2.2 4.3 0 7.8 3.5 7.8 7.8 0 .8-.1 1.6-.3 2.4 2.9 1.9 4.8 5.1 4.8 8.8 0 5.7-4.6 10.3-10.3 10.3H23.8z"/>\</svg>') repeat-x;
    background-size: auto 300px; /* 控制云朵大小 */
    animation: cloudMove 120s linear infinite; /* 调慢速度 */
}

@keyframes cloudMove {
    from { background-position: 100% 0; }  /* 从右侧开始 */
    to { background-position: -100% 0; }   /* 移动到左侧 */
}


        .dev-container {
            max-width: 1200px;
            margin: 30px auto;
            padding: 30px;
            background: rgba(0,0,0,0.8);
            border-radius: 15px;
            box-shadow: 0 8px 30px rgba(0,0,0,0.5);
        }

        .game-type-selector {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        .type-card {
            background: #1a1a1a;
            padding: 25px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
        }

        .type-card:hover {
            transform: translateY(-5px);
            border-color: #ff6b6b;
            box-shadow: 0 5px 15px rgba(255,107,107,0.3);
        }

        .type-card.active {
            border-color: #00ff88;
            background: linear-gradient(45deg, #1a1a1a, #2a2a2a);
        }

        .game-form {
            display: none;
            background: #2a2a2a;
            padding: 30px;
            border-radius: 15px;
            margin-top: 30px;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            margin-bottom: 10px;
            color: #00ff88;
            font-size: 16px;
        }

        .cover-preview {
            width: 300px;
            height: 180px;
            border: 2px dashed #666;
            border-radius: 8px;
            overflow: hidden;
            position: relative;
        }

        .cover-preview img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .tag-selector {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .tag-item {
            background: #333;
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .tag-item.selected {
            background: #00ff88;
            color: #1a1a1a;
        }

        #submitBtn {
            background: linear-gradient(45deg, #00ff88, #00ccff);
            padding: 10px 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: none;
            border-radius: 30px;
            color: #1a1a1a;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.3s;
            min-width: 120px;
            box-shadow: 0 4px 15px rgba(41, 182, 246, 0.3);
        }

        #submitBtn:hover {
            transform: scale(1.02);
        }
    </style>
        <link rel="stylesheet" href="./shouye.css">
</head>
<body>

    <header>
        <div class="logo"><img src="img/logo.png" height="49" width="156"/></div>
        <div class="topbq">
            <ul>
                <li><a href="#" class="top-bq" style="color: orange">预约</a></li>
                <li><a href="ceshi.html" class="top-bq">订阅</a></li>
                <li><a href="#" class="top-bq">社区</a></li>
                <li class="dropdown-container">
                    <a href="#" class="top-bq">更多 ▼</a>
                    <div class="dropdown-menu">
                        <div class="dropdown-item" onclick="showNotifications()">📩 通知</div>
                        <div class="dropdown-item" onclick="showSettings()">⚙️ 设置</div>
                        <!-- 开发者专属 -->
                        <div class="dev-item" onclick="location.href='kaifa.html'">💻 开发者中心</div>
                    </div>
                </li>
            </ul>
        </div>
        <div class="search-bar">
            <input type="text" placeholder="搜索..." style="height: 30px;width: 350px;border-top-left-radius: 15px;border-bottom-left-radius: 15px;border: none;background: whitesmoke">
            <button style="margin-left:-10px;height: 40px;width: 60px;border-bottom-right-radius:15px;border-top-right-radius:15px;border: none;background: whitesmoke;color: black ">搜索</button>
        </div>
        <div class="login">
            <a href="library.html">
            <button type="download"  >我的游戏库</button>
            </a>
        </div>
    </header>
    <div style="height: 65px;width: 100%"></div>
    <div class="cloud-bg"></div>
    <div class="dev-container">
        <h1 style="color: #00ff88; text-align: center; margin-bottom: 40px;">🎮 游戏创作中心</h1>
        
        <div class="game-type-selector">
            <div class="type-card" onclick="selectType('reserve')">
                <h3>预约游戏</h3>
                <p>适用于未发布的游戏，通过审核后将显示在预约页面</p>
            </div>
            <div class="type-card" onclick="selectType('subscribe')">
                <h3>订阅游戏</h3>
                <p>适用于已发布游戏，通过审核后显示在订阅页面</p>
            </div>
        </div>

        <form id="gameForm" class="game-form">
            <div class="form-group">
                <label>游戏名称</label>
                <input type="text" id="gameTitle" required>
            </div>

            <div class="form-group">
                <label>游戏描述</label>
                <textarea id="gameDesc" rows="4" required></textarea>
            </div>

            <div class="form-group">
                <label>上传封面</label>
                <div class="cover-preview" onclick="document.getElementById('coverInput').click()">
                    <img id="coverPreview" src="img/upload_placeholder.png">
                </div>
                <input type="file" id="coverInput" hidden accept="image/*">
            </div>

            <!-- <div class="form-group">
                <label>选择标签</label>
                <div class="tag-selector" id="tagContainer">
                    <div class="tag-item" data-tag="冒险">冒险</div>
                    <div class="tag-item" data-tag="角色扮演">角色扮演</div>
                    <div class="tag-item" data-tag="策略">策略</div>
                    <div class="tag-item" data-tag="多人合作">多人合作</div>
                </div>
            </div> -->
            <div class="form-group">
                <label>游戏标签（最多3个）</label>
                <div class="tag-selector" id="tagContainer"></div>
              </div>

            <button type="button" id="submitBtn" onclick="submitGame()">提交审核</button>
        </form>
    </div>

   
</body>
<script>
    // 类型卡片切换逻辑
    document.querySelectorAll('.type-card').forEach(card => {
            card.addEventListener('click', function() {
                const isActive = this.classList.contains('active');
                document.querySelectorAll('.type-card').forEach(c => c.classList.remove('active'));
                this.classList.toggle('active', !isActive);
                document.getElementById('gameForm').style.display = isActive ? 'none' : 'block';
            });
        });
    // 封面预览
    document.getElementById('coverInput').addEventListener('change', function(e) {
        const file = e.target.files[0];
        const reader = new FileReader();
        reader.onload = function(e) {
            document.getElementById('coverPreview').src = e.target.result;
        }
        reader.readAsDataURL(file);
    });

    // 标签选择
    document.querySelectorAll('.tag-item').forEach(tag => {
        tag.addEventListener('click', function() {
            this.classList.toggle('selected');
        });
    });
            // 初始化标签选择
        async function initTags() {
          const res = await fetch('/api/tags');
          const tags = await res.json();
          const container = document.getElementById('tagContainer');
        
          tags.forEach(tag => {
            const div = document.createElement('div');
            div.className = 'tag-item';
            div.textContent = tag.name;
            div.dataset.tagId = tag.id;
            div.onclick = () => toggleTag(tag.id);
            container.appendChild(div);
          });
        }

        let selectedTags = [];
        function toggleTag(tagId) {
          const index = selectedTags.indexOf(tagId);
          if (index > -1) {
            selectedTags.splice(index, 1);
          } else if (selectedTags.length < 3) {
            selectedTags.push(tagId);
          }
          updateTagDisplay();
        }
    // 提交游戏
    async function submitGame() {
            const gameTitle = document.getElementById('gameTitle').value;
            const gameDesc = document.getElementById('gameDesc').value;
            
            // 基础验证
            if (!gameTitle || gameTitle.length < 5) {
                alert('游戏名称需至少5个字符');
                return;
            }

            if (!gameDesc || gameDesc.length < 20) {
                alert('游戏描述需至少20个字符');
                return;
            }

            const gameData = {
                title: gameTitle,
                desc: gameDesc,
                type: document.querySelector('.type-card.active')?.dataset.type, // 通过data-type获取类型
                tags: [...document.querySelectorAll('.tag-item.selected')].map(t => t.dataset.tag),
                cover: document.getElementById('coverPreview').src
            };

            try {
                const response = await fetch('/api/submit-game', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${localStorage.getItem('authToken')}`
                    },
                    body: JSON.stringify(gameData)
                });

                const result = await response.json();
                
                if(response.ok) {
                    alert('✅ 提交成功！审核结果将通过站内信通知');
                    resetForm();
                    // 实际开发中应跳转到审核列表页
                } else {
                    alert(`❌ 提交失败: ${result.message}`);
                }
            } catch (error) {
                console.error('提交错误:', error);
                alert('网络错误，请稍后重试');
            }
        }
        function setupValidation() {
            document.getElementById('gameTitle').addEventListener('input', function(e) {
                const isValid = e.target.value.length >= 5;
                this.style.border = isValid ? '2px solid #00ff88' : '2px solid #ff6b6b';
            });

            document.getElementById('gameDesc').addEventListener('input', function(e) {
                const isValid = e.target.value.length >= 20;
                this.style.border = isValid ? '2px solid #00ff88' : '2px solid #ff6b6b';
            });
        }
    function resetForm() {
        document.getElementById('gameForm').reset();
        document.getElementById('coverPreview').src = 'img/upload_placeholder.png';
        document.querySelectorAll('.tag-item').forEach(t => t.classList.remove('selected'));
    }
    // 动态表单验证
    document.getElementById('gameTitle').addEventListener('input', function(e) {
        this.style.borderColor = e.target.value.length > 4 ? '#4fc3f7' : '#ff6b6b';
    });
    
    // 文件上传美化
    document.getElementById('coverInput').addEventListener('change', function(e) {
        const fileName = e.target.files[0]?.name || '未选择文件';
        document.querySelector('.cover-preview').setAttribute('data-text', fileName);
    });
</script>
</html>